# 25. 01. 08

## Team Project(Eat Platform) 진행

* 예약 관련 스케쥴 시스템 구조 정리

```
기존 구조에서는 달력 날짜 생성 -> 날짜 선택(클릭) -> 해당 일자에 대한 시간 테이블 생성
순서로 구조가 진행되어,
비동기로 데이터를 가져와서 비교하는 부분을 시간 테이블 생성 부분에서 실행해야 하는 오류가 있었고,
그로인해 날짜를 선택하는 시점에서 해당 일자의 특정 시간에 예약 스케쥴일 비교하는 부분에서
콜백의 시점이 다른 오류가 발생함.

예시로 1월 7일을 클릭하면 
예약 정보 (인원 시간 등)을 담고 있는 리스트의 정보가 갱신되지 않고,
추가적으로 한 번 더 클릭 했을 경우 갱신되는 상황이 발생.
기존 구조에서는 날짜를 선택하는 시점에서 시간 테이블을 생성하고 데이터를 읽기 때문에 
데이터가 생성되고 갱신되는 시점이 맞지 않는 것으로 판단.

이후 날짜를 클릭하는 시점에 
데이터를 먼저 갱신 하도록 하고,
불러오는데 성공했을 때(succecss) 타임 테이블을 생성하도록 변경

이후 해당 오류 해결 완료함.
```

* 주소 검색 API 적용 완료 및 데이터 정제 진행 중.

1) 주소 정보 테이블 생성 완료.

* 해당 데이터를 사용해서 가게 약도, 주소 카테고리 등 제작 예정

```
주소 정보 테이블 

[ STORE_ADDRESS ]

STORE_ID NUMBER PRIMARY KEY,
SIDO VARCHAR2(100) NOT NULL (시/도)
SIGUNGU VARCHAR2(100) NOT NULL (시/군/구)
BNAME1 VARCHAR2(100) (읍/면) : 동 일 경우는 공백
BNAME2 VARCHAR2(100) NOT NULL (동/리)
ROAD_ADDRESS VARCHAR2(1000) (도로명 주소)
JIBUN_ADDERESS VARCHAR(1000) (지번 주소)
DETAIL_ADDRESS VARCHAR(500) (상세 주소)
EXTRA_ADDRESS VARCHAR(500) (참고 항목)
POST_CODE NUMBER NOT NULL (우편번호)
```

[ 추가 정리 사항 ]

```
1. 지번 주소는 반드시 존재
2. 도로명 주소가 없을 경우도 있음.
2-2. 도로명 주소가 빈 값일 경우 지번 주소의 유무를 판단하여 도로명 주소 값을 지번 주소로 할당.
3. 하나의 지번 주소에 대한 도로명 주소는 오직 하나인 것을 확인.
4. 법정읍/면이 없을 경우 해당 칸은 공백이 생김. 공백 허용 해야함.
5. 광역시, 특별시, 특별자치시의 경우 시의 정보가 '도' 위치에 들어가고 '시' 란이 공백으로 들어감. 해당 란 공백 허용 해야함.
```

## EatFlatfrom 25. 01. 08 회의록

## Spring Security 적용 관련 논의

* 기존 Session 운용을 통해 USER 정보를 이용하는 방법을 보안을 위해 Spring Security를 적용하는 방향으로 논의
* 기존 작업 중 Session을 사용 파트에서 해당 구문을 제거하고, Spring Security 내부 적용된 CSRF 적용을 위한 태그, 코드 적용 고지

## 중간 점검 논의

### 회원 관리

1) ID, PW, Email, 연락처를 입력 받아 해당 정보를 통해 회원 등록 가능
2) 회원 등록, ID 찾기, PW 찾기(초기화) 진행 시 Email 인증 방식으로 본인 인증 시스템 구현
3) 회원 정보 삭제(탈퇴)의 경우는 삭제 데이터 전용 테이블을 생성하여 해당 데이터 활성/비활성 여부 판별 후 데이터 관리

### 예약 관리

1) 가게 상세페이지 내에서 온라인 예약 버튼을 통해 예약 진행 가능

* 예약을 시도하려는 가게, 날짜의 최대 수용 가능한 예약 가능 인원, 이미 예약된 인원을 계산하여 선택한 날짜의 시간에 대한 예약 가능 여부 판별

``` 예시로
한 파트에 예약을 최대 8명까지 받을 수 있는 식당의 경우
현재 예약이 0명이라는 가정이라면,
해당 파트에 8명까지 선택 및 예약 가능.

기존에 해당 파트의 대한 예약이 4명이 있는 경우라면,
인원 선택 파트에서 4명을 초과하는 인원을 선택하려는 경우 차단 및 예약 불가능 
```

* 허나 날짜/시간에 대한 예약 정보를 갱신하는 타이밍이 캘린더의 날짜 부분을 클릭했을 때의 시점이다 보니 페이지 로드 당시의 당일은 제대로 집계되지 않는 부분을 발견.
* 해당 부분은 추후 콜백 포커스를 수정하는 것으로 논의 완료.

2) 예약 정보 삭제 기능 구현

* 현재는 해당 예약 정보 삭제 시 데이터가 삭제되는 방식으로 구현했지만, 추후 취소된 예약 정보도 조회할 수 있는가에 대해 논의.

### 업장 관리

1) USER_ID, STORE_NAME, STORE_PHONE, OWNER_NAME, BUSINESS_HOUR, FOOD_CATEGORY, RESERV_LIMIT, SEAT, STORE_COMMENT, DESCRIPTION을 정보를 입력받아 가게 등록 가능.

* 현재는 USER_ID를 제공 받는 방식을 Session을 통해 전달 받고 있지만, Spring Security 적용을 통해 변경 예정.
* 멤버 별 권한 설정 진행 후 ROLE_STORE일 경우만 등록할 수 있도록 변경 예정.
* 현재 정보 등록 당시에 주소를 입력 받기 위해 주소 검색 API를 적용 중 및 해당 테이블 생성 완료.

2) 업장을 등록한 후에 등록한 인원이 해당 업장의 수정을 시도하면 수정 페이지로 이동 및 마지막 정보를 기점으로 정보를 조회 및 수정 가능

* 해당 파트 또한 Spring Security 적용을 통해 접근 방식 변경 예정.
* 해당 파트에도 주소 관련 사항 적용 예정.
* 현재는 Session 방식으로 작성자의 ID가 아닐 경우 접근 차단 적용

3) 등록된 정보를 토대로 식당 리스트, 상세 페이지 조회 가능

* 리스트에서 게시글(식당)을 클릭해 해당 상세 페이지로 이동 가능.
* 상세 페이지 내에서 해당 식당에 대한 예약, 리뷰 작성 구현 및 연동 완료.
* 페이지 Header에 포함된 검색창을 통해 정보를 검색 가능.
* 검색 가능한 정보는 식당 이름, 카테고리, 식당 소개, 식당 상세 설명, 메뉴, 메뉴 설명.
* 복합 키워드 검색 구현. ex) 1번 식당 "서울 대창 구이", 2번 식당 메뉴 "함흥냉면" / 검색 키워드 "대창 냉면" 두 결과 모두 조회됨.


### 메뉴 관리

1) 등록된 식당 정보를 토대로 해당 식당에 메뉴 항목을 추가할 수 있도록 구현.

* MENU_NAME, PRICE, MENU_COMMENT, REPRESENT 정보를 입력받아 특정 식당의 메뉴 등록 가능.
* REPRESENT 항목은 한 식당에 최대 2개까지 설정 가능하며, 추후 대표 메뉴 항목이 들어가는 부분에서 강조되는 컨텐츠로 추가 예정
* Session 방식으로 식당 등록을 진행한 ID가 아닐 경우 접근 차단.
* 추후 메뉴 이미지 등록 구현 예정


2) 특정 식당의 상세 페이지 내부에서 식당에 등록 메뉴의 정보를 조회 가능.

* 등록된 정보로 토대로 View단에서 정보를 조회 가능
* 가격의 경우 원화 표기 기준으로 3 자릿수 마다 자동으로 구분자 및 원화 표시 되도록 구현. ex) PRICE = 3000000 / View = 3,000,000 \

### 리뷰 관리

1) 사용자는 로그인을 했다면 특정 식당 상세 페이지 내부에 리뷰를 등록할 수 있음.

* 등록 당시에 점수, 감정표현 태그, 리뷰 내용을 등록할 수 있음.
* 태그는 태그 리스트에서 클릭하여 선택 시 숫자로 해당 값의 데이터를 넣을 수 있도록 구현.

2) 사용자는 등록된 리뷰를 수정/삭제를 할 수 있음.

* 점수, 리뷰 내용, 태그를 수정할 수 있음.
* 수정에 대한 UI는 아직 미구현
* 사용자(작성자)의 대한 유효성 판별은 아직 미구현

3) 사용자는 리뷰에 대한 추천/신고가 가능.

* 같은 리뷰에 대한 추천/신고는 중복을 판별하여 차단.

4) 사용자(업장 등록자)는 리뷰에 추가 댓글을 등록할 수 있음.(REPLY)

* 사용자는 특정 댓글에 대한 코멘트를 등록할 수 있음.
* 사용자(업장 등록자)에 대한 유효성 체크는 아직 미구현

## 추후 추가 기능 논의

### 리뷰 추천에 대한 포인트 제도

* 리뷰 추천에 대한 리턴으로 추천 수에 비례하여 작성자에게 포인트를 부여 혹은 사이트 이벤트로 사용자에게 포인트 부여.
* 해당 포인트로 사이트에서 제공하는 쿠폰/이벤트 등을 이용할 수 있음

### 업장 연계 상품 판매 논의

* 등록된 업장에 한하여 업장의 상품을 판매할 수 있는 포맷 구현 (밀키트 등 해당 식당의 키 상품)
* 결제 시스템 구현


### 주소를 기반한 전국 지도형 카테고리 메뉴

* 업장의 주소를 입력받아 해당 주소를 카테고리로 사용함.
* 지도의 지역을 클릭하면 해당 지역에 등록된 식당 리스트를 조회 가능.
